---
import SectionContainer from "../SectionContainer.astro";

// Traer los proyecto con Content Collections
import { getCollection, type CollectionEntry } from "astro:content";

type Project = CollectionEntry<"projects">;

const projects: Project[] = (await getCollection("projects")).sort(
  (a: Project, b: Project) => a.data.id - b.data.id
);
---

<SectionContainer id="proyectos">
  <h2 class="text-4xl sm:text-6xl font-bold mb-3">
    Proyecto üóÇÔ∏è
  </h2>
  {
    projects.map((project: Project) => (
      <article class="bg-white/10 backdrop-blur-lg border border-white/10 rounded-2xl shadow-lg grid md:grid-cols-[1fr_2fr] gap-6 p-6 my-4">
        <section class="carousel-container relative">
          <ul class="carousel" role="list">
            {project.data.images.map(
              (img: { src: string; alt?: string }, i: number) => (
                <li id={`${project.slug}-slide${i + 1}`}>
                  <img
                    src={img.src}
                    alt={img.alt ?? project.data.title}
                    class="carousel-img w-full object-cover"
                  />
                </li>
              )
            )}
          </ul>

          <div class="carousel-controls absolute bottom-4 left-0 right-0 flex justify-center gap-2">
            {project.data.images.map((_: unknown, i: number) => (
              <a
                href={`#${project.slug}-slide${i + 1}`}
                class="w-3 h-3 rounded-full bg-white opacity-60 hover:opacity-100"
              />
            ))}
          </div>
        </section>

        <div>
          <h1 class="text-3xl font-bold">{project.data.title}</h1>

          <p class="text-xl mb-1">{project.data.description}</p>

          <ul class="grid grid-cols-2 gap-2 my-4">
            {project.data.functionality.map((item: string) => (
              <li>{item}</li>
            ))}
          </ul>

          <a
            href={project.data.github}
            target="_blank"
            rel="noopener noreferrer"
            class="text-[#ac70c4]"
          >
            M√°s sobre el proyecto
          </a>
          <a href="">Repositorio del proyecto</a>
        </div>
      </article>
    ))
  }
</SectionContainer>
